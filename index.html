<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8" />
    <title>Flash Cards (EN / ZH / TH)</title>
    <!-- è®“æ‰‹æ©Ÿæ­£ç¢ºç¸®æ”¾ -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="bg-light py-4">
    <div class="container-fluid container-md">
        <!-- æ¨™é¡Œåˆ— -->
        <header class="mb-3">
            <h1 class="h4 mb-3 text-center text-md-start">Flash Cards (EN / ZH / TH)</h1>
            <p class="text-muted mb-0 text-left mx-4 text-md-start">
                Just for you and me.
            </p>
            <p class="text-muted mb-0 text-left mx-4 text-md-start">
                I hope that next time we meet, we can chat in English naturally. ğŸ˜Š
            </p>
        </header>

        <!-- å·¥å…·åˆ—ï¼šå–®å­—æ¸…å–®æŒ‰éˆ•ï¼ˆè§¸ç™¼å´é‚Š Offcanvasï¼‰ -->
        <div class="d-flex justify-content-between align-items-center mb-3 mx-3">
            <div class="small text-muted">
                Flashcards Numï¼š
                <span class="badge bg-primary" id="cardCount">0</span>
            </div>
            <button class="btn btn-outline-primary btn-sm" type="button" data-bs-toggle="offcanvas"
                data-bs-target="#wordListOffcanvas" aria-controls="wordListOffcanvas">
                ğŸ“š List
            </button>
        </div>

        <!-- å´é‚Šå–®å­—æ¸…å–® Offcanvas -->
        <div class="offcanvas offcanvas-start" tabindex="-1" id="wordListOffcanvas"
            aria-labelledby="wordListOffcanvasLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="wordListOffcanvasLabel">Flash Card List</h5>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
            </div>
            <div class="offcanvas-body p-0">
                <ul class="list-group list-group-flush" id="wordList"></ul>
            </div>
        </div>

        <!-- å–®å­—å¡ä¸»å€å¡Š -->
        <div class="card shadow-sm" id="cardContainer" style="display: none;">
            <!-- æ¨™é¡Œèˆ‡åˆ‡æ›æŒ‰éˆ•ï¼ˆæ¡Œæ©Ÿç‰ˆåœ¨ headerï¼Œæ‰‹æ©Ÿç‰ˆåœ¨ body ä¸Šæ–¹ï¼‰ -->
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="text-truncate">
                    <span class="badge bg-primary me-2" id="cardIndexBadge">#1 / 1</span>
                    <strong id="wordEnTitle">word</strong>
                </div>
                <!-- æ¡Œæ©Ÿ / å¹³æ¿ï¼šå³ä¸Šè§’å°æŒ‰éˆ• -->
                <div class="btn-group d-none d-md-flex" role="group" aria-label="Card navigation desktop">
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="prevBtn">
                        â—€ Previous
                    </button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="nextBtn">
                        NEXT â–¶
                    </button>
                </div>
            </div>

            <!-- å…§å®¹å€ï¼šè‹± / ä¸­ / æ³° -->
            <div class="card-body">
                <!-- æ‰‹æ©Ÿç‰ˆï¼šæŠŠä¸Šä¸€å¼µ / ä¸‹ä¸€å¼µç§»åˆ° card-body ä¸Šæ–¹ -->
                <div class="mb-3 d-flex d-md-none gap-2">
                    <button type="button" class="btn btn-outline-secondary w-50" id="prevBtnMobile">
                        â—€ Previous
                    </button>
                    <button type="button" class="btn btn-outline-secondary w-50" id="nextBtnMobile">
                        NEXT â–¶
                    </button>
                </div>

                <div class="row g-3">
                    <!-- è‹±æ–‡å€å¡Š -->
                    <div class="col-12 col-lg-4">
                        <div class="border rounded-3 p-3 h-100 bg-white">
                            <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                                <h5 class="mb-0">English</h5>
                                <div class="btn-group btn-group-sm" role="group">
                                    <button type="button" class="btn btn-outline-primary" id="speakEnWordBtn">
                                        ğŸ”Š Word
                                    </button>
                                    <button type="button" class="btn btn-outline-primary" id="speakEnSentenceBtn">
                                        ğŸ”Š Sentence
                                    </button>
                                </div>
                            </div>
                            <hr class="my-2" />
                            <p class="mb-1">
                                <span class="fw-bold">Wordï¼š</span>
                                <span id="wordEn"></span>
                            </p>
                            <p class="mb-0">
                                <span class="fw-bold">Sentenceï¼š</span>
                                <span id="sentenceEn"></span>
                            </p>
                        </div>
                    </div>

                    <!-- ä¸­æ–‡å€å¡Š -->
                    <div class="col-12 col-lg-4">
                        <div class="border rounded-3 p-3 h-100 bg-white">
                            <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                                <h5 class="mb-0">ä¸­æ–‡</h5>
                                <div class="btn-group btn-group-sm" role="group">
                                    <button type="button" class="btn btn-outline-success" id="speakZhWordBtn">
                                        ğŸ”Š å–®å­—
                                    </button>
                                    <button type="button" class="btn btn-outline-success" id="speakZhSentenceBtn">
                                        ğŸ”Š å¥å­
                                    </button>
                                </div>
                            </div>
                            <hr class="my-2" />
                            <p class="mb-1">
                                <span class="fw-bold">å–®å­—ï¼š</span>
                                <span id="wordZh"></span>
                            </p>
                            <p class="text-muted mb-2">
                                <span class="fw-bold">æ‹¼éŸ³ï¼š</span>
                                <span id="wordZhPinyin"></span>
                            </p>
                            <p class="mb-1">
                                <span class="fw-bold">ä¾‹å¥ï¼š</span>
                                <span id="sentenceZh"></span>
                            </p>
                            <p class="text-muted mb-0">
                                <span class="fw-bold">ä¾‹å¥æ‹¼éŸ³ï¼š</span>
                                <span id="sentenceZhPinyin"></span>
                            </p>
                        </div>
                    </div>

                    <!-- æ³°æ–‡å€å¡Š -->
                    <div class="col-12 col-lg-4">
                        <div class="border rounded-3 p-3 h-100 bg-white">
                            <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                                <h5 class="mb-0">à¸ à¸²à¸©à¸²à¹„à¸—à¸¢</h5>
                                <div class="btn-group btn-group-sm" role="group">
                                    <button type="button" class="btn btn-outline-warning" id="speakThWordBtn">
                                        ğŸ”Š à¸„à¸³à¸¨à¸±à¸à¸—à¹Œ
                                    </button>
                                    <button type="button" class="btn btn-outline-warning" id="speakThSentenceBtn">
                                        ğŸ”Š à¸›à¸£à¸°à¹‚à¸¢à¸„
                                    </button>
                                </div>
                            </div>
                            <hr class="my-2" />
                            <p class="mb-1">
                                <span class="fw-bold">à¸„à¸³à¸¨à¸±à¸à¸—à¹Œï¼š</span>
                                <span id="wordTh"></span>
                            </p>
                            <p class="mb-0">
                                <span class="fw-bold">à¸›à¸£à¸°à¹‚à¸¢à¸„ï¼š</span>
                                <span id="sentenceTh"></span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç„¡è³‡æ–™æç¤º -->
        <div class="alert alert-warning mt-3" id="noDataAlert" style="display: none;">
            ç›®å‰æ²’æœ‰ä»»ä½•å–®å­—å¡è³‡æ–™ï¼Œè«‹ç¢ºèª JSON å…§å®¹ã€‚
        </div>
    </div>

    <!-- Bootstrap 5 JS (å« Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ä¸»ç¨‹å¼ï¼šå–®å­—å¡é‚è¼¯ -->
    <script>
        // === 1. å–®å­— JSON è³‡æ–™ ===
        const cards = [
            {
                word: 'hug',
                zh: 'æ“æŠ±',
                zh_pinyin: 'yong bao',
                th: 'à¸à¸­à¸”',
                examples: {
                    en: {
                        sentence: 'She gave me a warm hug before leaving.',
                        word: 'hug',
                    },
                    zh: {
                        sentence: 'å¥¹é›¢é–‹ä¹‹å‰çµ¦äº†æˆ‘ä¸€å€‹æº«æš–çš„æ“æŠ±ã€‚',
                        sentence_pinyin:
                            'ta li kai zhi qian gei le wo yi ge wen nuan de yong bao',
                        word: 'æ“æŠ±',
                        word_pinyin: 'yong bao',
                    },
                    th: {
                        sentence: 'à¹€à¸˜à¸­à¸à¸­à¸”à¸‰à¸±à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸­à¸šà¸­à¸¸à¹ˆà¸™à¸à¹ˆà¸­à¸™à¸ˆà¸°à¹„à¸›',
                        word: 'à¸à¸­à¸”',
                    },
                },
            },
            {
                word: 'scent',
                zh: 'é¦™å‘³',
                zh_pinyin: 'xiang wei',
                th: 'à¸à¸¥à¸´à¹ˆà¸™à¸«à¸­à¸¡',
                examples: {
                    en: {
                        sentence: 'The scent of fresh flowers filled the room.',
                        word: 'scent',
                    },
                    zh: {
                        sentence: 'æ–°é®®èŠ±æœµçš„é¦™å‘³å……æ»¿äº†æ•´å€‹æˆ¿é–“ã€‚',
                        sentence_pinyin:
                            'xin xian hua duo de xiang wei chong man le zheng ge fang jian',
                        word: 'é¦™å‘³',
                        word_pinyin: 'xiang wei',
                    },
                    th: {
                        sentence: 'à¸à¸¥à¸´à¹ˆà¸™à¸«à¸­à¸¡à¸‚à¸­à¸‡à¸”à¸­à¸à¹„à¸¡à¹‰à¸ªà¸”à¸­à¸šà¸­à¸§à¸¥à¹„à¸›à¸—à¸±à¹ˆà¸§à¸«à¹‰à¸­à¸‡',
                        word: 'à¸à¸¥à¸´à¹ˆà¸™à¸«à¸­à¸¡',
                    },
                },
            },
            {
                word: 'pervy',
                zh: 'è®Šæ…‹çš„',
                zh_pinyin: 'bian tai de',
                th: 'à¸¥à¸²à¸¡à¸',
                examples: {
                    en: {
                        sentence: 'He made a pervy joke that made everyone uncomfortable.',
                        word: 'pervy',
                    },
                    zh: {
                        sentence:
                            'ä»–é–‹äº†ä¸€å€‹è®Šæ…‹çš„ç©ç¬‘ï¼Œè®“å¤§å®¶éƒ½è¦ºå¾—ä¸èˆ’æœã€‚',
                        sentence_pinyin:
                            'ta kai le yi ge bian tai de wan xiao rang da jia dou jue de bu shu fu',
                        word: 'è®Šæ…‹çš„',
                        word_pinyin: 'bian tai de',
                    },
                    th: {
                        sentence: 'à¹€à¸‚à¸²à¸à¸¹à¸”à¸¡à¸¸à¸à¸¥à¸²à¸¡à¸à¸—à¸µà¹ˆà¸—à¸³à¹ƒà¸«à¹‰à¸—à¸¸à¸à¸„à¸™à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸­à¸¶à¸”à¸­à¸±à¸”',
                        word: 'à¸¥à¸²à¸¡à¸',
                    },
                },
            },
        ];

        // === 2. DOM å…ƒç´ å–å¾— ===
        const cardContainer = document.getElementById('cardContainer');
        const noDataAlert = document.getElementById('noDataAlert');
        const cardCount = document.getElementById('cardCount');
        const wordList = document.getElementById('wordList');
        const wordListOffcanvasEl = document.getElementById('wordListOffcanvas');

        const cardIndexBadge = document.getElementById('cardIndexBadge');
        const wordEnTitle = document.getElementById('wordEnTitle');

        const wordEnEl = document.getElementById('wordEn');
        const sentenceEnEl = document.getElementById('sentenceEn');

        const wordZhEl = document.getElementById('wordZh');
        const wordZhPinyinEl = document.getElementById('wordZhPinyin');
        const sentenceZhEl = document.getElementById('sentenceZh');
        const sentenceZhPinyinEl = document.getElementById('sentenceZhPinyin');

        const wordThEl = document.getElementById('wordTh');
        const sentenceThEl = document.getElementById('sentenceTh');

        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // æ‰‹æ©Ÿç‰ˆå°èˆªæŒ‰éˆ•
        const prevBtnMobile = document.getElementById('prevBtnMobile');
        const nextBtnMobile = document.getElementById('nextBtnMobile');

        // ç™¼éŸ³æŒ‰éˆ•
        const speakEnWordBtn = document.getElementById('speakEnWordBtn');
        const speakEnSentenceBtn = document.getElementById('speakEnSentenceBtn');
        const speakZhWordBtn = document.getElementById('speakZhWordBtn');
        const speakZhSentenceBtn = document.getElementById('speakZhSentenceBtn');
        const speakThWordBtn = document.getElementById('speakThWordBtn');
        const speakThSentenceBtn = document.getElementById('speakThSentenceBtn');

        // === 3. ç‹€æ…‹ï¼šç›®å‰é¡¯ç¤ºå“ªä¸€å¼µå¡ç‰‡ ===
        let currentIndex = 0;

        // === 4. æ¸²æŸ“å–®å­—å¡å…§å®¹ ===
        function renderCard() {
            if (!cards.length) return;

            if (currentIndex < 0) currentIndex = 0;
            if (currentIndex >= cards.length) currentIndex = cards.length - 1;

            const card = cards[currentIndex];

            cardIndexBadge.textContent = `#${currentIndex + 1} / ${cards.length}`;
            wordEnTitle.textContent = card.word;

            // è‹±æ–‡å€
            wordEnEl.textContent = card.word || '';
            sentenceEnEl.textContent = card.examples?.en?.sentence || '';

            // ä¸­æ–‡å€
            wordZhEl.textContent = card.zh || '';
            wordZhPinyinEl.textContent = card.zh_pinyin || '';
            sentenceZhEl.textContent = card.examples?.zh?.sentence || '';
            sentenceZhPinyinEl.textContent =
                card.examples?.zh?.sentence_pinyin || '';

            // æ³°æ–‡å€
            wordThEl.textContent = card.th || '';
            sentenceThEl.textContent = card.examples?.th?.sentence || '';

            // æ›´æ–°æ¸…å–®æ¨£å¼
            updateWordListActive();
        }

        // === 5. å»ºç«‹æ¸…å–®é …ç›®ï¼ˆå´é‚Šæ¸…å–®ï¼‰ ===
        function buildWordList() {
            wordList.innerHTML = '';
            cards.forEach((card, index) => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className =
                    'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
                btn.dataset.index = index;

                const leftSpan = document.createElement('span');
                leftSpan.textContent = card.word;

                const rightSmall = document.createElement('small');
                rightSmall.className = 'text-muted';
                rightSmall.textContent = `${card.zh} / ${card.th}`;

                btn.appendChild(leftSpan);
                btn.appendChild(rightSmall);

                btn.addEventListener('click', () => {
                    currentIndex = index;
                    renderCard();
                });

                wordList.appendChild(btn);
            });
            cardCount.textContent = cards.length.toString();
        }

        // ä½¿ç”¨ Bootstrap çš„æ·ºè‰²æ¨£å¼ä¾†æ¨™è¨˜ç•¶å‰é …ç›®
        function updateWordListActive() {
            const items = wordList.querySelectorAll('button.list-group-item');
            items.forEach((el, idx) => {
                el.classList.remove('list-group-item-light', 'fw-bold');
                if (idx === currentIndex) {
                    el.classList.add('list-group-item-light', 'fw-bold');
                }
            });
        }

        // è®“å´é‚Šæ¸…å–®åœ¨é–‹å•Ÿæ™‚ï¼Œæ²å‹•åˆ°ç•¶å‰å–®å­—å¡
        function scrollActiveWordIntoView() {
            const items = wordList.querySelectorAll('button.list-group-item');
            if (!items.length) return;
            const target = items[currentIndex];
            if (target && typeof target.scrollIntoView === 'function') {
                target.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Offcanvas é–‹å•Ÿå¾Œï¼Œè®“ç•¶å‰é …ç›®è‡ªå‹•æ²åˆ°ä¸­é–“
        if (wordListOffcanvasEl) {
            wordListOffcanvasEl.addEventListener('shown.bs.offcanvas', () => {
                scrollActiveWordIntoView();
            });
        }

        // === 6. èªéŸ³ç™¼éŸ³åŠŸèƒ½ï¼ˆä½¿ç”¨ SpeechSynthesisï¼‰ ===
        let voices = [];

        function loadVoices() {
            if (!('speechSynthesis' in window)) return;
            voices = window.speechSynthesis.getVoices();
        }

        if ('speechSynthesis' in window) {
            loadVoices();
            window.speechSynthesis.onvoiceschanged = loadVoices;
        }

        function getVoiceForLang(lang) {
            if (!voices || !voices.length) return null;
            const lowerLang = lang.toLowerCase();
            // å„ªå…ˆå®Œå…¨åŒ¹é…ï¼Œå…¶æ¬¡å‰ç¶´åŒ¹é…
            let voice =
                voices.find((v) => v.lang.toLowerCase() === lowerLang) ||
                voices.find((v) => v.lang.toLowerCase().startsWith(lowerLang));
            return voice || null;
        }

        function speak(text, lang) {
            if (!('speechSynthesis' in window)) {
                alert('æ­¤ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆåŠŸèƒ½ã€‚');
                return;
            }
            if (!text) {
                alert('ç›®å‰æ²’æœ‰å¯æœ—è®€çš„å…§å®¹ã€‚');
                return;
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;

            // è©¦è‘—é¸æ“‡é©åˆèªç³»çš„ voice
            const voice = getVoiceForLang(lang);
            if (voice) {
                utterance.voice = voice;
            }

            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
        }

        // === 7. å°èˆªé‚è¼¯ï¼ˆä¸Šä¸€å¼µ / ä¸‹ä¸€å¼µï¼‰ ===
        function gotoPrev() {
            if (!cards.length) return;
            currentIndex = (currentIndex - 1 + cards.length) % cards.length;
            renderCard();
        }

        function gotoNext() {
            if (!cards.length) return;
            currentIndex = (currentIndex + 1) % cards.length;
            renderCard();
        }

        // æ¡Œæ©Ÿç‰ˆæŒ‰éˆ•
        prevBtn.addEventListener('click', gotoPrev);
        nextBtn.addEventListener('click', gotoNext);

        // æ‰‹æ©Ÿç‰ˆæŒ‰éˆ•
        if (prevBtnMobile && nextBtnMobile) {
            prevBtnMobile.addEventListener('click', gotoPrev);
            nextBtnMobile.addEventListener('click', gotoNext);
        }

        // === 8. ç™¼éŸ³æŒ‰éˆ• ===
        // è‹±æ–‡ï¼šå–®å­— / å¥å­
        speakEnWordBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            speak(card.word, 'en-US');
        });

        speakEnSentenceBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            const textToSpeak = card.examples?.en?.sentence || card.word;
            speak(textToSpeak, 'en-US');
        });

        // ä¸­æ–‡ï¼šå–®å­— / å¥å­
        speakZhWordBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            const textToSpeak =
                card.examples?.zh?.word || card.zh || '';
            speak(textToSpeak, 'zh-CN');
        });

        speakZhSentenceBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            const textToSpeak =
                card.examples?.zh?.sentence || card.zh || '';
            speak(textToSpeak, 'zh-CN');
        });

        // æ³°æ–‡ï¼šå–®å­— / å¥å­
        speakThWordBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            const textToSpeak =
                card.examples?.th?.word || card.th || '';
            speak(textToSpeak, 'th-TH');
        });

        speakThSentenceBtn.addEventListener('click', () => {
            const card = cards[currentIndex];
            const textToSpeak =
                card.examples?.th?.sentence || card.th || '';
            speak(textToSpeak, 'th-TH');
        });

        // === 9. åˆå§‹åŒ– ===
        function init() {
            if (!cards.length) {
                cardContainer.style.display = 'none';
                noDataAlert.style.display = 'block';
                return;
            }
            buildWordList();
            cardContainer.style.display = 'block';
            noDataAlert.style.display = 'none';
            renderCard();
        }

        init();
    </script>
</body>

</html>
